
    <!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>热点新闻分析</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" integrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoeqMV/TJlSKda6FXzoEyYGjTe+vXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <style>
            * { box-sizing: border-box; }
            body { 
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
                margin: 0; 
                padding: 16px; 
                background: #fafafa;
                color: #333;
                line-height: 1.5;
            }
            
            .container {
                max-width: 600px;
                margin: 0 auto;
                background: white;
                border-radius: 12px;
                overflow: hidden;
                box-shadow: 0 2px 16px rgba(0,0,0,0.06);
            }
            
            .header {
                background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
                color: white;
                padding: 32px 24px;
                text-align: center;
                position: relative;
            }
            
            .save-buttons {
                position: absolute;
                top: 16px;
                right: 16px;
                display: flex;
                gap: 8px;
            }
            
            .save-btn {
                background: rgba(255, 255, 255, 0.2);
                border: 1px solid rgba(255, 255, 255, 0.3);
                color: white;
                padding: 8px 16px;
                border-radius: 6px;
                cursor: pointer;
                font-size: 13px;
                font-weight: 500;
                transition: all 0.2s ease;
                backdrop-filter: blur(10px);
                white-space: nowrap;
            }
            
            .save-btn:hover {
                background: rgba(255, 255, 255, 0.3);
                border-color: rgba(255, 255, 255, 0.5);
                transform: translateY(-1px);
            }
            
            .save-btn:active {
                transform: translateY(0);
            }
            
            .save-btn:disabled {
                opacity: 0.6;
                cursor: not-allowed;
            }
            
            .header-title {
                font-size: 22px;
                font-weight: 700;
                margin: 0 0 20px 0;
            }
            
            .header-info {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 16px;
                font-size: 14px;
                opacity: 0.95;
            }
            
            .info-item {
                text-align: center;
            }
            
            .info-label {
                display: block;
                font-size: 12px;
                opacity: 0.8;
                margin-bottom: 4px;
            }
            
            .info-value {
                font-weight: 600;
                font-size: 16px;
            }
            
            .content {
                padding: 24px;
            }
            
            .word-group {
                margin-bottom: 40px;
            }
            
            .word-group:first-child {
                margin-top: 0;
            }
            
            .word-header {
                display: flex;
                align-items: center;
                justify-content: space-between;
                margin-bottom: 20px;
                padding-bottom: 8px;
                border-bottom: 1px solid #f0f0f0;
            }
            
            .word-info {
                display: flex;
                align-items: center;
                gap: 12px;
            }
            
            .word-name {
                font-size: 17px;
                font-weight: 600;
                color: #1a1a1a;
            }
            
            .word-count {
                color: #666;
                font-size: 13px;
                font-weight: 500;
            }
            
            .word-count.hot { color: #dc2626; font-weight: 600; }
            .word-count.warm { color: #ea580c; font-weight: 600; }
            
            .word-index {
                color: #999;
                font-size: 12px;
            }
            
            .news-item {
                margin-bottom: 20px;
                padding: 16px 0;
                border-bottom: 1px solid #f5f5f5;
                position: relative;
                display: flex;
                gap: 12px;
                align-items: center;
            }
            
            .news-item:last-child {
                border-bottom: none;
            }
            
            .news-item.new::after {
                content: "NEW";
                position: absolute;
                top: 12px;
                right: 0;
                background: #fbbf24;
                color: #92400e;
                font-size: 9px;
                font-weight: 700;
                padding: 3px 6px;
                border-radius: 4px;
                letter-spacing: 0.5px;
            }
            
            .news-number {
                color: #999;
                font-size: 13px;
                font-weight: 600;
                min-width: 20px;
                text-align: center;
                flex-shrink: 0;
                background: #f8f9fa;
                border-radius: 50%;
                width: 24px;
                height: 24px;
                display: flex;
                align-items: center;
                justify-content: center;
                align-self: flex-start;
                margin-top: 8px;
            }
            
            .news-content {
                flex: 1;
                min-width: 0;
                padding-right: 40px;
            }
            
            .news-item.new .news-content {
                padding-right: 50px;
            }
            
            .news-header {
                display: flex;
                align-items: center;
                gap: 8px;
                margin-bottom: 8px;
                flex-wrap: wrap;
            }
            
            .source-name {
                color: #666;
                font-size: 12px;
                font-weight: 500;
            }
            
            .rank-num {
                color: #fff;
                background: #6b7280;
                font-size: 10px;
                font-weight: 700;
                padding: 2px 6px;
                border-radius: 10px;
                min-width: 18px;
                text-align: center;
            }
            
            .rank-num.top { background: #dc2626; }
            .rank-num.high { background: #ea580c; }
            
            .time-info {
                color: #999;
                font-size: 11px;
            }
            
            .count-info {
                color: #059669;
                font-size: 11px;
                font-weight: 500;
            }
            
            .news-title {
                font-size: 15px;
                line-height: 1.4;
                color: #1a1a1a;
                margin: 0;
            }
            
            .news-link {
                color: #2563eb;
                text-decoration: none;
            }
            
            .news-link:hover {
                text-decoration: underline;
            }
            
            .news-link:visited {
                color: #7c3aed;
            }
            
            .new-section {
                margin-top: 40px;
                padding-top: 24px;
                border-top: 2px solid #f0f0f0;
            }
            
            .new-section-title {
                color: #1a1a1a;
                font-size: 16px;
                font-weight: 600;
                margin: 0 0 20px 0;
            }
            
            .new-source-group {
                margin-bottom: 24px;
            }
            
            .new-source-title {
                color: #666;
                font-size: 13px;
                font-weight: 500;
                margin: 0 0 12px 0;
                padding-bottom: 6px;
                border-bottom: 1px solid #f5f5f5;
            }
            
            .new-item {
                display: flex;
                align-items: center;
                gap: 12px;
                padding: 8px 0;
                border-bottom: 1px solid #f9f9f9;
            }
            
            .new-item:last-child {
                border-bottom: none;
            }
            
            .new-item-number {
                color: #999;
                font-size: 12px;
                font-weight: 600;
                min-width: 18px;
                text-align: center;
                flex-shrink: 0;
                background: #f8f9fa;
                border-radius: 50%;
                width: 20px;
                height: 20px;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .new-item-rank {
                color: #fff;
                background: #6b7280;
                font-size: 10px;
                font-weight: 700;
                padding: 3px 6px;
                border-radius: 8px;
                min-width: 20px;
                text-align: center;
                flex-shrink: 0;
            }
            
            .new-item-rank.top { background: #dc2626; }
            .new-item-rank.high { background: #ea580c; }
            
            .new-item-content {
                flex: 1;
                min-width: 0;
            }
            
            .new-item-title {
                font-size: 14px;
                line-height: 1.4;
                color: #1a1a1a;
                margin: 0;
            }
            
            .error-section {
                background: #fef2f2;
                border: 1px solid #fecaca;
                border-radius: 8px;
                padding: 16px;
                margin-bottom: 24px;
            }
            
            .error-title {
                color: #dc2626;
                font-size: 14px;
                font-weight: 600;
                margin: 0 0 8px 0;
            }
            
            .error-list {
                list-style: none;
                padding: 0;
                margin: 0;
            }
            
            .error-item {
                color: #991b1b;
                font-size: 13px;
                padding: 2px 0;
                font-family: 'SF Mono', Consolas, monospace;
            }
            
            .footer {
                margin-top: 32px;
                padding: 20px 24px;
                background: #f8f9fa;
                border-top: 1px solid #e5e7eb;
                text-align: center;
            }
            
            .footer-content {
                font-size: 13px;
                color: #6b7280;
                line-height: 1.6;
            }
            
            .footer-link {
                color: #4f46e5;
                text-decoration: none;
                font-weight: 500;
                transition: color 0.2s ease;
            }
            
            .footer-link:hover {
                color: #7c3aed;
                text-decoration: underline;
            }
            
            .project-name {
                font-weight: 600;
                color: #374151;
            }
            
            @media (max-width: 480px) {
                body { padding: 12px; }
                .header { padding: 24px 20px; }
                .content { padding: 20px; }
                .footer { padding: 16px 20px; }
                .header-info { grid-template-columns: 1fr; gap: 12px; }
                .news-header { gap: 6px; }
                .news-content { padding-right: 45px; }
                .news-item { gap: 8px; }
                .new-item { gap: 8px; }
                .news-number { width: 20px; height: 20px; font-size: 12px; }
                .save-buttons {
                    position: static;
                    margin-bottom: 16px;
                    display: flex;
                    gap: 8px;
                    justify-content: center;
                    flex-direction: column;
                    width: 100%;
                }
                .save-btn {
                    width: 100%;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <div class="save-buttons">
                    <button class="save-btn" onclick="saveAsImage()">保存为图片</button>
                    <button class="save-btn" onclick="saveAsMultipleImages()">分段保存</button>
                </div>
                <div class="header-title">热点新闻分析</div>
                <div class="header-info">
                    <div class="info-item">
                        <span class="info-label">报告类型</span>
                        <span class="info-value">实时分析</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">新闻总数</span>
                        <span class="info-value">130 条</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">热点新闻</span>
                        <span class="info-value">58 条</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">生成时间</span>
                        <span class="info-value">11-12 07:28</span>
                    </div>
                </div>
            </div>
            
            <div class="content">
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name"># —— 宏观与能源 —— 油价 WTI原油 布伦特原油 黄金 白银 能源股 天然气 OPEC 能源危机 新能源 碳中和 绿色能源 锂矿 光伏 储能技术 稀土</div>
                            <div class="word-count hot">16 条</div>
                        </div>
                        <div class="word-index">1/8</div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">30</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251112224901543800" target="_blank" class="news-link">WTI原油即时价差自2月以来首次转为溢价。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">26</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251112225221477800" target="_blank" class="news-link">现货油价加速下行 美油大跌3%</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">快讯通</span><span class="rank-num ">19</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.fastbull.com/cn/fastshort/3769843_0_1" target="_blank" class="news-link">【行情】WTI原油即时价差自2月以来首次转为溢价。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">4</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">快讯通</span><span class="rank-num ">18</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.fastbull.com/cn/fastshort/3769849_0_1" target="_blank" class="news-link">【行情】WTI原油日内大跌3.00%，现报59.14美元/桶；布伦特原油跌2.65%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">5</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社电报</span><span class="rank-num ">17</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://api3.cls.cn/share/article/2198876?os=web&amp;sv=8.4.6&amp;app=CailianpressWeb" target="_blank" class="news-link">国际油价持续走低 WTI原油跌3%</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">6</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 快讯</span><span class="rank-num ">17</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/livenews/3003515" target="_blank" class="news-link">现货黄金短线拉升，刷新日高，逼近4160美元，涨幅扩大至将近0.8%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">7</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">14</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251112230701350800" target="_blank" class="news-link">英国对欧盟天然气出口创一年多新高 利用地区价差盈利</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">8</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 快讯</span><span class="rank-num ">14</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/livenews/3003502" target="_blank" class="news-link">现货白银日内涨幅达2.0%，报52.22美元/盎司。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">9</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 快讯</span><span class="rank-num ">13</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/livenews/3003503" target="_blank" class="news-link">WTI原油日内跌幅达3.0%，报59.16美元/桶。 WTI原油即时价差自2月以来首次转为溢价。 上期所原油期货夜盘目前跌2.4%。 乌克兰能源部长Hrynchuk在发生行业贪腐调查之后宣布辞职，自称没有任何不当行为。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">10</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">11</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251112231101622800" target="_blank" class="news-link">现货黄金短线走高逾15美元，突破4150美元/盎司，日内涨0.58%。纽约期金日内涨幅扩大至1%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">11</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">快讯通</span><span class="rank-num high">4-24</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.fastbull.com/cn/fastshort/3769913_0_1" target="_blank" class="news-link">【行情】现货黄金短线走高逾15美元，突破4150美元/盎司，日内涨0.58%。纽约期金日内涨幅扩大至1%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">12</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">快讯通</span><span class="rank-num top">1-21</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.fastbull.com/cn/fastshort/3769922_0_1" target="_blank" class="news-link">【行情】现货黄金30分钟内拉升近40美元，站上4170美元/盎司，日内涨1.06%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">13</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社电报</span><span class="rank-num high">4</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://api3.cls.cn/share/article/2198893?os=web&amp;sv=8.4.6&amp;app=CailianpressWeb" target="_blank" class="news-link">财联社11月12日电，现货黄金向上触及4150美元，日内上涨0.64%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">14</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 快讯</span><span class="rank-num high">4</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/livenews/3003516" target="_blank" class="news-link">现货黄金短线拉升，突破4160美元刷新日高，涨幅0.8%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">15</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num top">3</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251112231800187800" target="_blank" class="news-link">现货黄金30分钟内拉升近40美元，站上4170美元/盎司，日内涨1.06%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">16</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社电报</span><span class="rank-num top">1</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://api3.cls.cn/share/article/2198896?os=web&amp;sv=8.4.6&amp;app=CailianpressWeb" target="_blank" class="news-link">财联社11月12日电，现货黄金日内涨幅扩大至1%，报4171.09美元/盎司。</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name"># —— 科技公司与巨头 —— 特斯拉 马斯克 苹果 库克 英伟达 黄仁勋 微软 纳德拉 谷歌 Alphabet 亚马逊 贝索斯 Meta 扎克伯格 AMD 英特尔 台积电 博通 高通 英伟达股价 OpenAI ChatGPT AI泡沫 人工智能 半导体 芯片 算力 GPU 数据中心 AI服务器 云计算</div>
                            <div class="word-count hot">15 条</div>
                        </div>
                        <div class="word-index">2/8</div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">16</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251112230209659800" target="_blank" class="news-link">Anthropic：将在美国投资500亿美元建设数据中心。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社热门</span><span class="rank-num ">13</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.cls.cn/detail/2198461" target="_blank" class="news-link">存储芯片涨价风暴前所未有！大摩上调三星、SK海力士目标价</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">12</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251112231010960800" target="_blank" class="news-link">报道： Anthropic计划投入500亿美元建设定制数据中心</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">4</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">雪球</span><span class="rank-num ">10</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://xueqiu.com/s/TSLA" target="_blank" class="news-link">特斯拉</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">5</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">9</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251112231305040800" target="_blank" class="news-link">Anthropic：与Fluidstack合作在得克萨斯州和纽约州建设数据中心，未来还将有更多计划。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">6</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 快讯</span><span class="rank-num ">8</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/livenews/3003511" target="_blank" class="news-link">Anthropic第一批数据中心将选址美国得州和纽约，将在美国数据中心开支500亿美元。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">7</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">IT之家</span><span class="rank-num ">7</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.ithome.com/0/897/024.htm" target="_blank" class="news-link">M1 芯片 Mac 不支持 Apple 智能？苹果美国官网再闹乌龙</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">8</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社电报</span><span class="rank-num ">7</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://api3.cls.cn/share/article/2198886?os=web&amp;sv=8.4.6&amp;app=CailianpressWeb" target="_blank" class="news-link">人工智能初创公司Anthropic将在美国投资500亿美元建设数据中心</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">9</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">IT之家</span><span class="rank-num high">5</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.ithome.com/0/897/026.htm" target="_blank" class="news-link">寒武纪拥抱众智 FlagOS 生态，打破不同架构芯片间的软件生态壁垒</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">10</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">IT之家</span><span class="rank-num high">4</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.ithome.com/0/897/027.htm" target="_blank" class="news-link">可将部分桌面应用转制成网页版，谷歌推“Cameyo”方案帮助企业从微软 Win 系统转型 ChromeOS</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">11</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 快讯</span><span class="rank-num top">3</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/livenews/3003517" target="_blank" class="news-link">Cassava Technologies宣布三笔交易（包括英伟达提供股权投资），将利用超过1.5亿美元新资本提供Liquid Techcommunications。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">12</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">IT之家</span><span class="rank-num top">2</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.ithome.com/0/897/029.htm" target="_blank" class="news-link">OpenAI：《纽约时报》要求公司交出 ChatGPT 用户聊天记录，已要求法院驳回</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">13</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">联合早报</span><span class="rank-num top">2</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.zaochenbao.com/news/china/202511/1257173.html" target="_blank" class="news-link">中国吁德国促荷兰撤销接管安世半导体</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">14</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 最新</span><span class="rank-num top">2</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3759248" target="_blank" class="news-link">Anthropic数据中心计划开支500亿美元！首批选址美国得州和纽约</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">15</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">IT之家</span><span class="rank-num top">1</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.ithome.com/0/897/030.htm" target="_blank" class="news-link">从反复修改到一劳永逸：苹果资深员工巧妙应对乔布斯对计算器界面的挑剔</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name"># —— 美股大盘与指数 —— 美股 纳斯达克 标普500 道琼斯 标普 美股收盘 盘前 盘后 科技股 蓝筹股 美股行情 股市暴跌 股市反弹 美股大跌 美股上涨 华尔街 机构投资者 资金流向 量化基金 ETF 财报 盈利预期 估值 并购 IPO 回购 空头 多头 市场情绪</div>
                            <div class="word-count hot">14 条</div>
                        </div>
                        <div class="word-index">3/8</div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">雪球</span><span class="rank-num ">27</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://xueqiu.com/s/KWEB" target="_blank" class="news-link">中概互联网指数ETF-KraneShares</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">22</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251112225707496800" target="_blank" class="news-link">标普500银行指数创历史新高，现涨2%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">15</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251112230532535800" target="_blank" class="news-link">AMD积极前景驱动基准指数走强 美股仍处于复杂情绪交织中</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">4</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">快讯通</span><span class="rank-num ">13</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.fastbull.com/cn/fastshort/3769861_100_1" target="_blank" class="news-link">【行情】标普500银行指数触及历史新高，现上涨2%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">5</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">快讯通</span><span class="rank-num ">12</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.fastbull.com/cn/fastshort/3769871_100_1" target="_blank" class="news-link">【行情】标普500指数医疗保健板块触及逾一年高位，现上涨1.2%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">6</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社电报</span><span class="rank-num ">10</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://api3.cls.cn/share/article/2198883?os=web&amp;sv=8.4.6&amp;app=CailianpressWeb" target="_blank" class="news-link">财联社11月12日电，标普500银行指数创历史新高，现涨2%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">7</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社电报</span><span class="rank-num ">9</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://api3.cls.cn/share/article/2198884?os=web&amp;sv=8.4.6&amp;app=CailianpressWeb" target="_blank" class="news-link">财联社11月12日电，美股走势分化，道琼斯指数涨1%，纳斯达克综合指数跌0.24%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">8</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">格隆汇</span><span class="rank-num ">7</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.gelonghui.com/news/5116751" target="_blank" class="news-link">美股异动丨核电公司Oklo涨超8%，新燃料制造设施取得关键监管进展</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">9</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 最热</span><span class="rank-num ">7</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3759214" target="_blank" class="news-link">受政府重开预期与科技股强势提振，美股指集体高开，AMD大涨8%，美债上扬，加密货币跳水</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">10</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">格隆汇</span><span class="rank-num high">5</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.gelonghui.com/news/5116753" target="_blank" class="news-link">美股异动丨礼来涨超3%创新高，公布实验性减肥药物2期临床研究的积极结果</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">11</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社电报</span><span class="rank-num high">5</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://api3.cls.cn/share/article/2198890?os=web&amp;sv=8.4.6&amp;app=CailianpressWeb" target="_blank" class="news-link">财联社11月12日电，美股航空服务板块盘初走强，联合大陆航空涨超5%，美国航空、达美航空涨超3%，西南航空涨超2%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">12</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 最新</span><span class="rank-num top">3</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3759214" target="_blank" class="news-link">受政府重开预期与科技股强势提振，美股指集体高开，AMD大涨8%，美债上扬，加密货币跳水</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">13</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">格隆汇</span><span class="rank-num top">2</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.gelonghui.com/news/5116756" target="_blank" class="news-link">美股异动丨摩根大通涨超2%创新高，向机构客户推出其美元存款代币JPM Coin</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">14</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">格隆汇</span><span class="rank-num top">1</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.gelonghui.com/news/5116757" target="_blank" class="news-link">美股异动丨NAND或迎来全面涨价潮，存储概念股走强</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name"># —— 金融与货币政策 —— 美联储 加息 降息 鲍威尔 CPI PPI 通胀 非农 失业率 美元指数 美债 国债收益率 量化紧缩 QE 货币政策 通货膨胀 经济衰退</div>
                            <div class="word-count warm">5 条</div>
                        </div>
                        <div class="word-index">4/8</div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">21</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251112225906405800" target="_blank" class="news-link">荷兰国际：财政紧缩将推升降息预期 英镑仍有下跌空间</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">13</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251112231000001800" target="_blank" class="news-link">美联储理事沃勒将于十分钟后参加第九届金融科技年度会议。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">快讯通</span><span class="rank-num ">10-30</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.fastbull.com/cn/fastshort/3769876_100_1" target="_blank" class="news-link">美国芝加哥联储主席保尔森在金融科技会议的发言中未对货币政策和经济前景发表评论。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">4</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">8</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251112231403459800" target="_blank" class="news-link">美联储博斯蒂克宣布退休 任期至明年二月结束</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">5</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 最新</span><span class="rank-num top">1</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3759247" target="_blank" class="news-link">高市早苗模糊表态支撑市场加息预期：央行政策对经济与通胀至关重要</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name"># —— 政府与政治 —— 美联储 鲍威尔 加息 降息 CPI PPI 通胀 通货膨胀 非农 经济衰退 失业率 美债 国债收益率 财政部 债务上限 美元指数 货币政策 财政刺激 拜登 特朗普 共和党 民主党 白宫 美国政府 国会 选举 大选 中期选举 制裁 关税 中美关系 对华政策 外交政策 贸易谈判 科技封锁</div>
                            <div class="word-count warm">5 条</div>
                        </div>
                        <div class="word-index">5/8</div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">23</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251112225646419800" target="_blank" class="news-link">报道：法国财政部长对预算案通过议会表示有信心</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">19</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251112230040357800" target="_blank" class="news-link">受益于欧元区和瑞典的财政刺激 瑞典克朗应保持强势</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">快讯通</span><span class="rank-num top">3-23</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.fastbull.com/cn/fastshort/3769914_100_1" target="_blank" class="news-link">捷克总统帕维尔要求选举获胜者Babis在被任命为总理前公开披露其避免利益冲突的措施。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">4</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">快讯通</span><span class="rank-num top">2-22</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.fastbull.com/cn/fastshort/3769915_101_1" target="_blank" class="news-link">特朗普政府新规：外国人可能被拒签的慢性疾病包括肥胖、高血压、心血管等</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">5</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 快讯</span><span class="rank-num high">5</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/livenews/3003514" target="_blank" class="news-link">特朗普政府新规：外国人可能被拒签的慢性疾病包括肥胖、高血压、心血管等</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name"># —— 热点主题 —— AI泡沫 科技裁员 并购 IPO 财报 盈利预期 估值 ETF 资金流向 市场波动 散户 机构投资者 空头 多头 市场情绪 量化基金</div>
                            <div class="word-count ">1 条</div>
                        </div>
                        <div class="word-index">6/8</div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 快讯</span><span class="rank-num ">12</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/livenews/3003505" target="_blank" class="news-link">阿拉比卡咖啡期货跌超5%，报3.7870美元/磅，投资者关注原油市场波动。</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name"># —————————————— # 💰 虚拟货币与区块链 # —————————————— 比特币 BTC 以太坊 ETH 币安 Binance Coinbase USDT USDC 稳定币 区块链 Web3 挖矿 算力 矿机 币圈 币价 币市 币灾 暴跌 暴涨 减半 比特币ETF 数字货币 虚拟货币监管 美SEC 加密监管 加密货币交易所</div>
                            <div class="word-count ">1 条</div>
                        </div>
                        <div class="word-index">7/8</div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 快讯</span><span class="rank-num ">15</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/livenews/3003501" target="_blank" class="news-link">比特币瞬间从10.47万美元附近跳水至接近10.35万美元的水平，日内整体涨幅迅速收窄至1.3%。</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name"># —————————————— # 🇨🇳 中国市场（与美股相关） # —————————————— 人民币 汇率 中概股 港股 恒生指数 北向资金 外资流入 中国经济 中美谈判 A股 沪深300 外汇储备 经济复苏 科技国产化</div>
                            <div class="word-count ">1 条</div>
                        </div>
                        <div class="word-index">8/8</div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社深度</span><span class="rank-num high">4</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.cls.cn/detail/2198864" target="_blank" class="news-link">三达膜人事调整！前董秘张靖霄分管纳滤业务出海 港股二次上市推进中</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="footer">
                <div class="footer-content">
                    由 <span class="project-name">TrendRadar</span> 生成 · 
                    <a href="https://github.com/sansan0/TrendRadar" target="_blank" class="footer-link">
                        GitHub 开源项目
                    </a>
                    <br>
                    <span style="color: #ea580c; font-weight: 500;">
                        发现新版本 3.0.5，当前版本 3.0.4
                    </span>
                </div>
            </div>
        </div>
        
        <script>
            async function saveAsImage() {
                const button = event.target;
                const originalText = button.textContent;
                
                try {
                    button.textContent = '生成中...';
                    button.disabled = true;
                    window.scrollTo(0, 0);
                    
                    // 等待页面稳定
                    await new Promise(resolve => setTimeout(resolve, 200));
                    
                    // 截图前隐藏按钮
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'hidden';
                    
                    // 再次等待确保按钮完全隐藏
                    await new Promise(resolve => setTimeout(resolve, 100));
                    
                    const container = document.querySelector('.container');
                    
                    const canvas = await html2canvas(container, {
                        backgroundColor: '#ffffff',
                        scale: 1.5,
                        useCORS: true,
                        allowTaint: false,
                        imageTimeout: 10000,
                        removeContainer: false,
                        foreignObjectRendering: false,
                        logging: false,
                        width: container.offsetWidth,
                        height: container.offsetHeight,
                        x: 0,
                        y: 0,
                        scrollX: 0,
                        scrollY: 0,
                        windowWidth: window.innerWidth,
                        windowHeight: window.innerHeight
                    });
                    
                    buttons.style.visibility = 'visible';
                    
                    const link = document.createElement('a');
                    const now = new Date();
                    const filename = `TrendRadar_热点新闻分析_${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}_${String(now.getHours()).padStart(2, '0')}${String(now.getMinutes()).padStart(2, '0')}.png`;
                    
                    link.download = filename;
                    link.href = canvas.toDataURL('image/png', 1.0);
                    
                    // 触发下载
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    button.textContent = '保存成功!';
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                    
                } catch (error) {
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'visible';
                    button.textContent = '保存失败';
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                }
            }
            
            async function saveAsMultipleImages() {
                const button = event.target;
                const originalText = button.textContent;
                const container = document.querySelector('.container');
                const scale = 1.5; 
                const maxHeight = 5000 / scale;
                
                try {
                    button.textContent = '分析中...';
                    button.disabled = true;
                    
                    // 获取所有可能的分割元素
                    const newsItems = Array.from(container.querySelectorAll('.news-item'));
                    const wordGroups = Array.from(container.querySelectorAll('.word-group'));
                    const newSection = container.querySelector('.new-section');
                    const errorSection = container.querySelector('.error-section');
                    const header = container.querySelector('.header');
                    const footer = container.querySelector('.footer');
                    
                    // 计算元素位置和高度
                    const containerRect = container.getBoundingClientRect();
                    const elements = [];
                    
                    // 添加header作为必须包含的元素
                    elements.push({
                        type: 'header',
                        element: header,
                        top: 0,
                        bottom: header.offsetHeight,
                        height: header.offsetHeight
                    });
                    
                    // 添加错误信息（如果存在）
                    if (errorSection) {
                        const rect = errorSection.getBoundingClientRect();
                        elements.push({
                            type: 'error',
                            element: errorSection,
                            top: rect.top - containerRect.top,
                            bottom: rect.bottom - containerRect.top,
                            height: rect.height
                        });
                    }
                    
                    // 按word-group分组处理news-item
                    wordGroups.forEach(group => {
                        const groupRect = group.getBoundingClientRect();
                        const groupNewsItems = group.querySelectorAll('.news-item');
                        
                        // 添加word-group的header部分
                        const wordHeader = group.querySelector('.word-header');
                        if (wordHeader) {
                            const headerRect = wordHeader.getBoundingClientRect();
                            elements.push({
                                type: 'word-header',
                                element: wordHeader,
                                parent: group,
                                top: groupRect.top - containerRect.top,
                                bottom: headerRect.bottom - containerRect.top,
                                height: headerRect.height
                            });
                        }
                        
                        // 添加每个news-item
                        groupNewsItems.forEach(item => {
                            const rect = item.getBoundingClientRect();
                            elements.push({
                                type: 'news-item',
                                element: item,
                                parent: group,
                                top: rect.top - containerRect.top,
                                bottom: rect.bottom - containerRect.top,
                                height: rect.height
                            });
                        });
                    });
                    
                    // 添加新增新闻部分
                    if (newSection) {
                        const rect = newSection.getBoundingClientRect();
                        elements.push({
                            type: 'new-section',
                            element: newSection,
                            top: rect.top - containerRect.top,
                            bottom: rect.bottom - containerRect.top,
                            height: rect.height
                        });
                    }
                    
                    // 添加footer
                    const footerRect = footer.getBoundingClientRect();
                    elements.push({
                        type: 'footer',
                        element: footer,
                        top: footerRect.top - containerRect.top,
                        bottom: footerRect.bottom - containerRect.top,
                        height: footer.offsetHeight
                    });
                    
                    // 计算分割点
                    const segments = [];
                    let currentSegment = { start: 0, end: 0, height: 0, includeHeader: true };
                    let headerHeight = header.offsetHeight;
                    currentSegment.height = headerHeight;
                    
                    for (let i = 1; i < elements.length; i++) {
                        const element = elements[i];
                        const potentialHeight = element.bottom - currentSegment.start;
                        
                        // 检查是否需要创建新分段
                        if (potentialHeight > maxHeight && currentSegment.height > headerHeight) {
                            // 在前一个元素结束处分割
                            currentSegment.end = elements[i - 1].bottom;
                            segments.push(currentSegment);
                            
                            // 开始新分段
                            currentSegment = {
                                start: currentSegment.end,
                                end: 0,
                                height: element.bottom - currentSegment.end,
                                includeHeader: false
                            };
                        } else {
                            currentSegment.height = potentialHeight;
                            currentSegment.end = element.bottom;
                        }
                    }
                    
                    // 添加最后一个分段
                    if (currentSegment.height > 0) {
                        currentSegment.end = container.offsetHeight;
                        segments.push(currentSegment);
                    }
                    
                    button.textContent = `生成中 (0/${segments.length})...`;
                    
                    // 隐藏保存按钮
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'hidden';
                    
                    // 为每个分段生成图片
                    const images = [];
                    for (let i = 0; i < segments.length; i++) {
                        const segment = segments[i];
                        button.textContent = `生成中 (${i + 1}/${segments.length})...`;
                        
                        // 创建临时容器用于截图
                        const tempContainer = document.createElement('div');
                        tempContainer.style.cssText = `
                            position: absolute;
                            left: -9999px;
                            top: 0;
                            width: ${container.offsetWidth}px;
                            background: white;
                        `;
                        tempContainer.className = 'container';
                        
                        // 克隆容器内容
                        const clonedContainer = container.cloneNode(true);
                        
                        // 移除克隆内容中的保存按钮
                        const clonedButtons = clonedContainer.querySelector('.save-buttons');
                        if (clonedButtons) {
                            clonedButtons.style.display = 'none';
                        }
                        
                        tempContainer.appendChild(clonedContainer);
                        document.body.appendChild(tempContainer);
                        
                        // 等待DOM更新
                        await new Promise(resolve => setTimeout(resolve, 100));
                        
                        // 使用html2canvas截取特定区域
                        const canvas = await html2canvas(clonedContainer, {
                            backgroundColor: '#ffffff',
                            scale: scale,
                            useCORS: true,
                            allowTaint: false,
                            imageTimeout: 10000,
                            logging: false,
                            width: container.offsetWidth,
                            height: segment.end - segment.start,
                            x: 0,
                            y: segment.start,
                            windowWidth: window.innerWidth,
                            windowHeight: window.innerHeight
                        });
                        
                        images.push(canvas.toDataURL('image/png', 1.0));
                        
                        // 清理临时容器
                        document.body.removeChild(tempContainer);
                    }
                    
                    // 恢复按钮显示
                    buttons.style.visibility = 'visible';
                    
                    // 下载所有图片
                    const now = new Date();
                    const baseFilename = `TrendRadar_热点新闻分析_${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}_${String(now.getHours()).padStart(2, '0')}${String(now.getMinutes()).padStart(2, '0')}`;
                    
                    for (let i = 0; i < images.length; i++) {
                        const link = document.createElement('a');
                        link.download = `${baseFilename}_part${i + 1}.png`;
                        link.href = images[i];
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                        
                        // 延迟一下避免浏览器阻止多个下载
                        await new Promise(resolve => setTimeout(resolve, 100));
                    }
                    
                    button.textContent = `已保存 ${segments.length} 张图片!`;
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                    
                } catch (error) {
                    console.error('分段保存失败:', error);
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'visible';
                    button.textContent = '保存失败';
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                }
            }
            
            document.addEventListener('DOMContentLoaded', function() {
                window.scrollTo(0, 0);
            });
        </script>
    </body>
    </html>
    