
    <!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>热点新闻分析</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" integrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoeqMV/TJlSKda6FXzoEyYGjTe+vXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <style>
            * { box-sizing: border-box; }
            body { 
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
                margin: 0; 
                padding: 16px; 
                background: #fafafa;
                color: #333;
                line-height: 1.5;
            }
            
            .container {
                max-width: 600px;
                margin: 0 auto;
                background: white;
                border-radius: 12px;
                overflow: hidden;
                box-shadow: 0 2px 16px rgba(0,0,0,0.06);
            }
            
            .header {
                background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
                color: white;
                padding: 32px 24px;
                text-align: center;
                position: relative;
            }
            
            .save-buttons {
                position: absolute;
                top: 16px;
                right: 16px;
                display: flex;
                gap: 8px;
            }
            
            .save-btn {
                background: rgba(255, 255, 255, 0.2);
                border: 1px solid rgba(255, 255, 255, 0.3);
                color: white;
                padding: 8px 16px;
                border-radius: 6px;
                cursor: pointer;
                font-size: 13px;
                font-weight: 500;
                transition: all 0.2s ease;
                backdrop-filter: blur(10px);
                white-space: nowrap;
            }
            
            .save-btn:hover {
                background: rgba(255, 255, 255, 0.3);
                border-color: rgba(255, 255, 255, 0.5);
                transform: translateY(-1px);
            }
            
            .save-btn:active {
                transform: translateY(0);
            }
            
            .save-btn:disabled {
                opacity: 0.6;
                cursor: not-allowed;
            }
            
            .header-title {
                font-size: 22px;
                font-weight: 700;
                margin: 0 0 20px 0;
            }
            
            .header-info {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 16px;
                font-size: 14px;
                opacity: 0.95;
            }
            
            .info-item {
                text-align: center;
            }
            
            .info-label {
                display: block;
                font-size: 12px;
                opacity: 0.8;
                margin-bottom: 4px;
            }
            
            .info-value {
                font-weight: 600;
                font-size: 16px;
            }
            
            .content {
                padding: 24px;
            }
            
            .word-group {
                margin-bottom: 40px;
            }
            
            .word-group:first-child {
                margin-top: 0;
            }
            
            .word-header {
                display: flex;
                align-items: center;
                justify-content: space-between;
                margin-bottom: 20px;
                padding-bottom: 8px;
                border-bottom: 1px solid #f0f0f0;
            }
            
            .word-info {
                display: flex;
                align-items: center;
                gap: 12px;
            }
            
            .word-name {
                font-size: 17px;
                font-weight: 600;
                color: #1a1a1a;
            }
            
            .word-count {
                color: #666;
                font-size: 13px;
                font-weight: 500;
            }
            
            .word-count.hot { color: #dc2626; font-weight: 600; }
            .word-count.warm { color: #ea580c; font-weight: 600; }
            
            .word-index {
                color: #999;
                font-size: 12px;
            }
            
            .news-item {
                margin-bottom: 20px;
                padding: 16px 0;
                border-bottom: 1px solid #f5f5f5;
                position: relative;
                display: flex;
                gap: 12px;
                align-items: center;
            }
            
            .news-item:last-child {
                border-bottom: none;
            }
            
            .news-item.new::after {
                content: "NEW";
                position: absolute;
                top: 12px;
                right: 0;
                background: #fbbf24;
                color: #92400e;
                font-size: 9px;
                font-weight: 700;
                padding: 3px 6px;
                border-radius: 4px;
                letter-spacing: 0.5px;
            }
            
            .news-number {
                color: #999;
                font-size: 13px;
                font-weight: 600;
                min-width: 20px;
                text-align: center;
                flex-shrink: 0;
                background: #f8f9fa;
                border-radius: 50%;
                width: 24px;
                height: 24px;
                display: flex;
                align-items: center;
                justify-content: center;
                align-self: flex-start;
                margin-top: 8px;
            }
            
            .news-content {
                flex: 1;
                min-width: 0;
                padding-right: 40px;
            }
            
            .news-item.new .news-content {
                padding-right: 50px;
            }
            
            .news-header {
                display: flex;
                align-items: center;
                gap: 8px;
                margin-bottom: 8px;
                flex-wrap: wrap;
            }
            
            .source-name {
                color: #666;
                font-size: 12px;
                font-weight: 500;
            }
            
            .rank-num {
                color: #fff;
                background: #6b7280;
                font-size: 10px;
                font-weight: 700;
                padding: 2px 6px;
                border-radius: 10px;
                min-width: 18px;
                text-align: center;
            }
            
            .rank-num.top { background: #dc2626; }
            .rank-num.high { background: #ea580c; }
            
            .time-info {
                color: #999;
                font-size: 11px;
            }
            
            .count-info {
                color: #059669;
                font-size: 11px;
                font-weight: 500;
            }
            
            .news-title {
                font-size: 15px;
                line-height: 1.4;
                color: #1a1a1a;
                margin: 0;
            }
            
            .news-link {
                color: #2563eb;
                text-decoration: none;
            }
            
            .news-link:hover {
                text-decoration: underline;
            }
            
            .news-link:visited {
                color: #7c3aed;
            }
            
            .new-section {
                margin-top: 40px;
                padding-top: 24px;
                border-top: 2px solid #f0f0f0;
            }
            
            .new-section-title {
                color: #1a1a1a;
                font-size: 16px;
                font-weight: 600;
                margin: 0 0 20px 0;
            }
            
            .new-source-group {
                margin-bottom: 24px;
            }
            
            .new-source-title {
                color: #666;
                font-size: 13px;
                font-weight: 500;
                margin: 0 0 12px 0;
                padding-bottom: 6px;
                border-bottom: 1px solid #f5f5f5;
            }
            
            .new-item {
                display: flex;
                align-items: center;
                gap: 12px;
                padding: 8px 0;
                border-bottom: 1px solid #f9f9f9;
            }
            
            .new-item:last-child {
                border-bottom: none;
            }
            
            .new-item-number {
                color: #999;
                font-size: 12px;
                font-weight: 600;
                min-width: 18px;
                text-align: center;
                flex-shrink: 0;
                background: #f8f9fa;
                border-radius: 50%;
                width: 20px;
                height: 20px;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .new-item-rank {
                color: #fff;
                background: #6b7280;
                font-size: 10px;
                font-weight: 700;
                padding: 3px 6px;
                border-radius: 8px;
                min-width: 20px;
                text-align: center;
                flex-shrink: 0;
            }
            
            .new-item-rank.top { background: #dc2626; }
            .new-item-rank.high { background: #ea580c; }
            
            .new-item-content {
                flex: 1;
                min-width: 0;
            }
            
            .new-item-title {
                font-size: 14px;
                line-height: 1.4;
                color: #1a1a1a;
                margin: 0;
            }
            
            .error-section {
                background: #fef2f2;
                border: 1px solid #fecaca;
                border-radius: 8px;
                padding: 16px;
                margin-bottom: 24px;
            }
            
            .error-title {
                color: #dc2626;
                font-size: 14px;
                font-weight: 600;
                margin: 0 0 8px 0;
            }
            
            .error-list {
                list-style: none;
                padding: 0;
                margin: 0;
            }
            
            .error-item {
                color: #991b1b;
                font-size: 13px;
                padding: 2px 0;
                font-family: 'SF Mono', Consolas, monospace;
            }
            
            .footer {
                margin-top: 32px;
                padding: 20px 24px;
                background: #f8f9fa;
                border-top: 1px solid #e5e7eb;
                text-align: center;
            }
            
            .footer-content {
                font-size: 13px;
                color: #6b7280;
                line-height: 1.6;
            }
            
            .footer-link {
                color: #4f46e5;
                text-decoration: none;
                font-weight: 500;
                transition: color 0.2s ease;
            }
            
            .footer-link:hover {
                color: #7c3aed;
                text-decoration: underline;
            }
            
            .project-name {
                font-weight: 600;
                color: #374151;
            }
            
            @media (max-width: 480px) {
                body { padding: 12px; }
                .header { padding: 24px 20px; }
                .content { padding: 20px; }
                .footer { padding: 16px 20px; }
                .header-info { grid-template-columns: 1fr; gap: 12px; }
                .news-header { gap: 6px; }
                .news-content { padding-right: 45px; }
                .news-item { gap: 8px; }
                .new-item { gap: 8px; }
                .news-number { width: 20px; height: 20px; font-size: 12px; }
                .save-buttons {
                    position: static;
                    margin-bottom: 16px;
                    display: flex;
                    gap: 8px;
                    justify-content: center;
                    flex-direction: column;
                    width: 100%;
                }
                .save-btn {
                    width: 100%;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <div class="save-buttons">
                    <button class="save-btn" onclick="saveAsImage()">保存为图片</button>
                    <button class="save-btn" onclick="saveAsMultipleImages()">分段保存</button>
                </div>
                <div class="header-title">热点新闻分析</div>
                <div class="header-info">
                    <div class="info-item">
                        <span class="info-label">报告类型</span>
                        <span class="info-value">实时分析</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">新闻总数</span>
                        <span class="info-value">162 条</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">热点新闻</span>
                        <span class="info-value">61 条</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">生成时间</span>
                        <span class="info-value">11-18 07:28</span>
                    </div>
                </div>
            </div>
            
            <div class="content">
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name"># —— 美股大盘与指数 —— 美股 纳斯达克 标普500 道琼斯 标普 美股收盘 盘前 盘后 科技股 蓝筹股 美股行情 股市暴跌 股市反弹 美股大跌 美股上涨 华尔街 机构投资者 资金流向 量化基金 ETF 财报 盈利预期 估值 并购 IPO 回购 空头 多头 市场情绪</div>
                            <div class="word-count hot">26 条</div>
                        </div>
                        <div class="word-index">1/7</div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 快讯</span><span class="rank-num ">29</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/livenews/3006590" target="_blank" class="news-link">标普500指数低开31.22点，跌幅0.47%，报6641.19点； 道琼斯工业平均指数低开207.32点，跌幅0.44%，报46382.92点； 纳斯达克综合指数低开142.17点，跌幅0.63%，报22565.90点。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 快讯</span><span class="rank-num ">28</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/livenews/3006592" target="_blank" class="news-link">行业ETF美股盘初普跌，半导体ETF跌超1.4%，全球科技股指数ETF跌超1.2%，可选消费ETF跌超1.1%，科技行业ETF跌超0.9%，网络股指数ETF跌超0.7%。 在标普500指数的11个板块中，可选消费板块盘初跌0.95%，科技板块跌0.56%，能源板块跌0.38%，电信板块目前涨0.17%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">24</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251118225641959800" target="_blank" class="news-link">美股三大股指均跌超1%。英伟达(NVDA.O)跌超3%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">4</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 快讯</span><span class="rank-num ">23</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/livenews/3006599" target="_blank" class="news-link">纳斯达克综合指数跌幅扩大至1%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">5</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">快讯通</span><span class="rank-num ">22</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.fastbull.com/cn/fastshort/3780824_100_1" target="_blank" class="news-link">瑞士ABB集团CEOMorten Wierod：并购领域是我们须加大投入的领域，需更注重项目储备。同时也将考虑规模更大的交易。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">6</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 快讯</span><span class="rank-num ">21</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/livenews/3006603" target="_blank" class="news-link">纳斯达克100指数下跌1%，刷新日低。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">7</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">快讯通</span><span class="rank-num ">19</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.fastbull.com/cn/fastshort/3780732_101_1" target="_blank" class="news-link">【行情】纳斯达克100指数下跌1%，刷新日低。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">8</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社电报</span><span class="rank-num ">18</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://api3.cls.cn/share/article/2204277?os=web&amp;sv=8.4.6&amp;app=CailianpressWeb" target="_blank" class="news-link">美股三大股指集体低开</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">9</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">雪球</span><span class="rank-num ">17</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://xueqiu.com/s/KWEB" target="_blank" class="news-link">中概互联网指数ETF-KraneShares</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">10</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社电报</span><span class="rank-num ">16</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://api3.cls.cn/share/article/2204279?os=web&amp;sv=8.4.6&amp;app=CailianpressWeb" target="_blank" class="news-link">财联社11月18日电，美股Olema Pharmaceuticals上涨167%触发熔断。奥本海默维持Olema Pharmaceuticals买入评级，并将目标价从22美元上调至45美元。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">11</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">格隆汇</span><span class="rank-num ">14</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.gelonghui.com/news/5120045" target="_blank" class="news-link">华检医疗(01931.HK)11月18日耗资800.2万港元回购131万股</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">12</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">格隆汇</span><span class="rank-num ">13</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.gelonghui.com/news/5120046" target="_blank" class="news-link">美股三大指数集体低开，亚马逊、微软跌近2%</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">13</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社电报</span><span class="rank-num ">13</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://api3.cls.cn/share/article/2204284?os=web&amp;sv=8.4.6&amp;app=CailianpressWeb" target="_blank" class="news-link">财联社11月18日电，纳斯达克综合指数跌幅扩大至1%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">14</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 快讯</span><span class="rank-num ">10</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/livenews/3006614" target="_blank" class="news-link">美股科技股七巨头指数大跌2.5%，超大市值科技股指数跌2.6%，双双刷新日低。 亚马逊跌3.6%，特斯拉跌3.4%，英伟达跌3.4%，Meta跌2.7%，微软跌2.3%，谷歌A跌1.5%，苹果跌0.2%。 费城半导体指数跌超3%。 此外，AMD跌6%，台积电跌2.8%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">15</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社电报</span><span class="rank-num ">9</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://api3.cls.cn/share/article/2204292?os=web&amp;sv=8.4.6&amp;app=CailianpressWeb" target="_blank" class="news-link">美股三大指数均创10月17日以来新低</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">16</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">快讯通</span><span class="rank-num ">7-29</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.fastbull.com/cn/fastshort/3780781_101_1" target="_blank" class="news-link">【行情】美股科技股七巨头指数大跌2.5%，超大市值科技股指数跌2.6%，双双刷新日低。亚马逊跌3.6%，特斯拉跌3.4%，英伟达跌3.4%，Meta跌2.7%，微软跌2.3%，谷歌A跌1.5%，苹果跌0.2%。费城半导体指数跌超3%。此外，AMD跌6%，台积电跌2.8%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">17</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">格隆汇</span><span class="rank-num ">8</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.gelonghui.com/news/5120051" target="_blank" class="news-link">美股异动丨携程涨约3.7%，Q3净利润同比大增，国际业务表现亮眼</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">18</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社电报</span><span class="rank-num ">8</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://api3.cls.cn/share/article/2204293?os=web&amp;sv=8.4.6&amp;app=CailianpressWeb" target="_blank" class="news-link">财联社11月18日电，美股存储芯片股走低，闪迪跌近10%，美光科技跌4.15%，西部数据跌3.8%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">19</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">6</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251118230930194800" target="_blank" class="news-link">金十图示：2025年11月17日（周一）美股热门股票行情一览（美股盘中）</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">20</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 快讯</span><span class="rank-num ">6</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/livenews/3006618" target="_blank" class="news-link">Prosus在11月10-14日按均价61.7431欧元回购股票112.0709万，总体耗资0.692亿欧元（折合0.8023亿美元）。 Naspers同期按均价1240.6461南非兰特回购43.6848万股，总体耗资5.420亿兰特（折合0.317亿美元）。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">21</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 快讯</span><span class="rank-num high">5</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/livenews/3006619" target="_blank" class="news-link">摩根大通副董事长警告称：AI估值可能出现“调整”</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">22</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">格隆汇</span><span class="rank-num top">3</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.gelonghui.com/news/5120056" target="_blank" class="news-link">美股异动丨美敦力涨超6%创近4年新高，第二财季业绩超预期</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">23</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 快讯</span><span class="rank-num top">2</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/livenews/3006622" target="_blank" class="news-link">据知情人士透露，德国量子计算供应商Raith考虑出售，希望于潜在交易获得大约10亿欧元估值。（彭博）</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">24</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 最热</span><span class="rank-num top">2</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3759603" target="_blank" class="news-link">全球市场恐慌发酵：美股指低开低走，欧股全线下跌，日本股债汇三杀，现货黄金反弹至4060美元</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">25</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">格隆汇</span><span class="rank-num top">1</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.gelonghui.com/news/5120058" target="_blank" class="news-link">美股异动丨多重因素叠加引发抛售，美股“七巨头”齐跌</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">26</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 最新</span><span class="rank-num top">1</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3759603" target="_blank" class="news-link">全球市场恐慌发酵：美股指低开低走，欧股全线下跌，日本股债汇三杀，现货黄金反弹至4060美元</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name"># —— 科技公司与巨头 —— 特斯拉 马斯克 苹果 库克 英伟达 黄仁勋 微软 纳德拉 谷歌 Alphabet 亚马逊 贝索斯 Meta 扎克伯格 AMD 英特尔 台积电 博通 高通 英伟达股价 OpenAI ChatGPT AI泡沫 人工智能 半导体 芯片 算力 GPU 数据中心 AI服务器 云计算</div>
                            <div class="word-count hot">23 条</div>
                        </div>
                        <div class="word-index">2/7</div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">雪球</span><span class="rank-num ">27</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://xueqiu.com/s/META" target="_blank" class="news-link">Meta</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">25</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251118225508306800" target="_blank" class="news-link">英伟达(NVDA.O)跌近3%，AMD(AMD.O)跌近5%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">雪球</span><span class="rank-num ">18</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://xueqiu.com/s/AAPL" target="_blank" class="news-link">苹果</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">4</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 快讯</span><span class="rank-num ">18</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/livenews/3006606" target="_blank" class="news-link">美国三大股指跌超1%，费城半导体指数跌超2.2%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">5</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">快讯通</span><span class="rank-num ">17</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.fastbull.com/cn/fastshort/3780744_101_1" target="_blank" class="news-link">【行情】美国三大股指跌超1%，费城半导体指数跌超2.2%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">6</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">16</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251118230118439800" target="_blank" class="news-link">微软、英伟达和Anthropic报告达成合作伙伴关系。Anthropic已承诺斥资300亿美元购买Azure计算能力。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">7</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">雪球</span><span class="rank-num ">16</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://xueqiu.com/s/AMD" target="_blank" class="news-link">AMD</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">8</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">15</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251118230155631800" target="_blank" class="news-link">微软承诺向Anthropic投资高达50亿美元。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">9</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">14</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251118230204652800" target="_blank" class="news-link">英伟达：微软和Anthropic也在扩大现有合作关系，以便为企业提供更广泛的Claude访问权限。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">10</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">13</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251118230322722800" target="_blank" class="news-link">英伟达：微软Azure AI Foundry的客户将能够访问Anthropic的Frontier Claude模型。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">11</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">12</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251118230416096800" target="_blank" class="news-link">英伟达承诺向Anthropic投资高达100亿美元。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">12</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">11</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251118230605376800" target="_blank" class="news-link">金十整理：云中断事件频发——谷歌云、AWS、Azure、Cloudflare接连中招</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">13</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 快讯</span><span class="rank-num ">9</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/livenews/3006615" target="_blank" class="news-link">Anthropic、英伟达、微软构建战略合作伙伴关系。 Anthropic承诺，将（向微软）采购价值300亿美元的Azure算力。 英伟达和微软向Anthropic做出投资承诺，英伟达将投资至多100亿美元、微软将出资至多50亿美元。 Anthropic表示，亚马逊仍将是其主要的云服务供应商。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">14</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">8</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251118230828934800" target="_blank" class="news-link">Anthropic：亚马逊仍是Anthropic的主要云服务提供商。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">15</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">7</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251118230836574800" target="_blank" class="news-link">Anthropic：Claude现已登陆微软Foundry和365 Copilot。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">16</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社电报</span><span class="rank-num ">7</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://api3.cls.cn/share/article/2204295?os=web&amp;sv=8.4.6&amp;app=CailianpressWeb" target="_blank" class="news-link">财联社11月18日电，英伟达跌超3%，AMD跌超5%。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">17</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">雪球</span><span class="rank-num high">5</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://xueqiu.com/s/TSLA" target="_blank" class="news-link">特斯拉</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">18</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社深度</span><span class="rank-num high">4</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.cls.cn/detail/2204289" target="_blank" class="news-link">行业深度分析师调低微软&amp;亚马逊评级 称应重新审视AI经济效益</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">19</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社电报</span><span class="rank-num top">3</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://api3.cls.cn/share/article/2204301?os=web&amp;sv=8.4.6&amp;app=CailianpressWeb" target="_blank" class="news-link">英伟达和微软将向投资人工智能初创公司Anthropic合计投资至多150亿美元</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">20</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">IT之家</span><span class="rank-num top">2</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.ithome.com/0/898/410.htm" target="_blank" class="news-link">苹果揭秘 Apple Watch Series 11/Ultra 3 钛金属表壳如何诞生：全用 3D 打印制成，节省 400 吨钛原料</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">21</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 最新</span><span class="rank-num top">2</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3759654" target="_blank" class="news-link">英伟达承诺，将对Anthropic投资至多100亿美元。微软承诺出资至多50亿美元</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">22</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">IT之家</span><span class="rank-num top">1</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.ithome.com/0/898/411.htm" target="_blank" class="news-link">150 亿美元投资 + 300 亿美元算力订单，微软、英伟达与 Anthropic 宣布建立战略合作伙伴关系</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">23</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社深度</span><span class="rank-num top">1</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.cls.cn/detail/2204305" target="_blank" class="news-link">迈信林拟与大股东共设创投基金 超两亿元投向其控股的算力配套公司|速读公告</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name"># —— 金融与货币政策 —— 美联储 加息 降息 鲍威尔 CPI PPI 通胀 非农 失业率 美元指数 美债 国债收益率 量化紧缩 QE 货币政策 通货膨胀 经济衰退</div>
                            <div class="word-count ">3 条</div>
                        </div>
                        <div class="word-index">3/7</div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">快讯通</span><span class="rank-num high">4-26</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.fastbull.com/cn/fastshort/3780791_100_1" target="_blank" class="news-link">英央行首席经济学家：勿过度解读短期通胀数据。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻 最新</span><span class="rank-num high">4</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3759652" target="_blank" class="news-link">“小非农”ADP周度就业数据：截至11月1日的四周，美国私营部门就业人数平均每周减少2500人</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num top">2</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251118232000001800" target="_blank" class="news-link">美联储理事巴尔将于十分钟后就银行监管发表讲话。</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name"># —————————————— # 💰 虚拟货币与区块链 # —————————————— 比特币 BTC 以太坊 ETH 币安 Binance Coinbase USDT USDC 稳定币 区块链 Web3 挖矿 算力 矿机 币圈 币价 币市 币灾 暴跌 暴涨 减半 比特币ETF 数字货币 虚拟货币监管 美SEC 加密监管 加密货币交易所</div>
                            <div class="word-count ">3 条</div>
                        </div>
                        <div class="word-index">4/7</div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社电报</span><span class="rank-num ">17</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://api3.cls.cn/share/article/2204278?os=web&amp;sv=8.4.6&amp;app=CailianpressWeb" target="_blank" class="news-link">比特币回升至9.2万美元上方</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">格隆汇</span><span class="rank-num ">12</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.gelonghui.com/news/5120047" target="_blank" class="news-link">比特币回升至9.2万美元上方</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num top">1</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251118232016624800" target="_blank" class="news-link">以太坊站上3100美元/枚，日内涨2.27%。</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name"># —— 政府与政治 —— 美联储 鲍威尔 加息 降息 CPI PPI 通胀 通货膨胀 非农 经济衰退 失业率 美债 国债收益率 财政部 债务上限 美元指数 货币政策 财政刺激 拜登 特朗普 共和党 民主党 白宫 美国政府 国会 选举 大选 中期选举 制裁 关税 中美关系 对华政策 外交政策 贸易谈判 科技封锁</div>
                            <div class="word-count ">2 条</div>
                        </div>
                        <div class="word-index">5/7</div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">28</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251118224959604800" target="_blank" class="news-link">特朗普的移民事务负责人汤姆·霍曼：计划在不久的将来前往纽约市开展（移民执法）行动。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">26</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251118225023047800" target="_blank" class="news-link">特朗普的移民事务负责人汤姆·霍曼：目前团队已经到位，但我们将进一步加强部署。</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name"># —— 宏观与能源 —— 油价 WTI原油 布伦特原油 黄金 白银 能源股 天然气 OPEC 能源危机 新能源 碳中和 绿色能源 锂矿 光伏 储能技术 稀土</div>
                            <div class="word-count ">2 条</div>
                        </div>
                        <div class="word-index">6/7</div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社电报</span><span class="rank-num ">14</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://api3.cls.cn/share/article/2204281?os=web&amp;sv=8.4.6&amp;app=CailianpressWeb" target="_blank" class="news-link">财联社11月18日电，现货白银日内涨幅扩大至1%，报50.69美元/盎司。</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社电报</span><span class="rank-num top">2</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://api3.cls.cn/share/article/2204306?os=web&amp;sv=8.4.6&amp;app=CailianpressWeb" target="_blank" class="news-link">甘肃稀土无钴低镍NFC贮氢粉实现产业化突破</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name"># —————————————— # 🇨🇳 中国市场（与美股相关） # —————————————— 人民币 汇率 中概股 港股 恒生指数 北向资金 外资流入 中国经济 中美谈判 A股 沪深300 外汇储备 经济复苏 科技国产化</div>
                            <div class="word-count ">2 条</div>
                        </div>
                        <div class="word-index">7/7</div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">金十数据</span><span class="rank-num ">9</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://flash.jin10.com/detail/20251118230824237800" target="_blank" class="news-link">金十图示：2025年11月18日（周二）热门中概股行情一览</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">联合早报</span><span class="rank-num ">6</span><span class="time-info">07时28分</span>
                            </div>
                            <div class="news-title"><a href="https://www.zaochenbao.com/news/china/202511/1857654.html" target="_blank" class="news-link">最高奖励1000万人民币 贵州新政激励数据产业</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="footer">
                <div class="footer-content">
                    由 <span class="project-name">TrendRadar</span> 生成 · 
                    <a href="https://github.com/sansan0/TrendRadar" target="_blank" class="footer-link">
                        GitHub 开源项目
                    </a>
                    <br>
                    <span style="color: #ea580c; font-weight: 500;">
                        发现新版本 3.0.5，当前版本 3.0.4
                    </span>
                </div>
            </div>
        </div>
        
        <script>
            async function saveAsImage() {
                const button = event.target;
                const originalText = button.textContent;
                
                try {
                    button.textContent = '生成中...';
                    button.disabled = true;
                    window.scrollTo(0, 0);
                    
                    // 等待页面稳定
                    await new Promise(resolve => setTimeout(resolve, 200));
                    
                    // 截图前隐藏按钮
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'hidden';
                    
                    // 再次等待确保按钮完全隐藏
                    await new Promise(resolve => setTimeout(resolve, 100));
                    
                    const container = document.querySelector('.container');
                    
                    const canvas = await html2canvas(container, {
                        backgroundColor: '#ffffff',
                        scale: 1.5,
                        useCORS: true,
                        allowTaint: false,
                        imageTimeout: 10000,
                        removeContainer: false,
                        foreignObjectRendering: false,
                        logging: false,
                        width: container.offsetWidth,
                        height: container.offsetHeight,
                        x: 0,
                        y: 0,
                        scrollX: 0,
                        scrollY: 0,
                        windowWidth: window.innerWidth,
                        windowHeight: window.innerHeight
                    });
                    
                    buttons.style.visibility = 'visible';
                    
                    const link = document.createElement('a');
                    const now = new Date();
                    const filename = `TrendRadar_热点新闻分析_${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}_${String(now.getHours()).padStart(2, '0')}${String(now.getMinutes()).padStart(2, '0')}.png`;
                    
                    link.download = filename;
                    link.href = canvas.toDataURL('image/png', 1.0);
                    
                    // 触发下载
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    button.textContent = '保存成功!';
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                    
                } catch (error) {
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'visible';
                    button.textContent = '保存失败';
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                }
            }
            
            async function saveAsMultipleImages() {
                const button = event.target;
                const originalText = button.textContent;
                const container = document.querySelector('.container');
                const scale = 1.5; 
                const maxHeight = 5000 / scale;
                
                try {
                    button.textContent = '分析中...';
                    button.disabled = true;
                    
                    // 获取所有可能的分割元素
                    const newsItems = Array.from(container.querySelectorAll('.news-item'));
                    const wordGroups = Array.from(container.querySelectorAll('.word-group'));
                    const newSection = container.querySelector('.new-section');
                    const errorSection = container.querySelector('.error-section');
                    const header = container.querySelector('.header');
                    const footer = container.querySelector('.footer');
                    
                    // 计算元素位置和高度
                    const containerRect = container.getBoundingClientRect();
                    const elements = [];
                    
                    // 添加header作为必须包含的元素
                    elements.push({
                        type: 'header',
                        element: header,
                        top: 0,
                        bottom: header.offsetHeight,
                        height: header.offsetHeight
                    });
                    
                    // 添加错误信息（如果存在）
                    if (errorSection) {
                        const rect = errorSection.getBoundingClientRect();
                        elements.push({
                            type: 'error',
                            element: errorSection,
                            top: rect.top - containerRect.top,
                            bottom: rect.bottom - containerRect.top,
                            height: rect.height
                        });
                    }
                    
                    // 按word-group分组处理news-item
                    wordGroups.forEach(group => {
                        const groupRect = group.getBoundingClientRect();
                        const groupNewsItems = group.querySelectorAll('.news-item');
                        
                        // 添加word-group的header部分
                        const wordHeader = group.querySelector('.word-header');
                        if (wordHeader) {
                            const headerRect = wordHeader.getBoundingClientRect();
                            elements.push({
                                type: 'word-header',
                                element: wordHeader,
                                parent: group,
                                top: groupRect.top - containerRect.top,
                                bottom: headerRect.bottom - containerRect.top,
                                height: headerRect.height
                            });
                        }
                        
                        // 添加每个news-item
                        groupNewsItems.forEach(item => {
                            const rect = item.getBoundingClientRect();
                            elements.push({
                                type: 'news-item',
                                element: item,
                                parent: group,
                                top: rect.top - containerRect.top,
                                bottom: rect.bottom - containerRect.top,
                                height: rect.height
                            });
                        });
                    });
                    
                    // 添加新增新闻部分
                    if (newSection) {
                        const rect = newSection.getBoundingClientRect();
                        elements.push({
                            type: 'new-section',
                            element: newSection,
                            top: rect.top - containerRect.top,
                            bottom: rect.bottom - containerRect.top,
                            height: rect.height
                        });
                    }
                    
                    // 添加footer
                    const footerRect = footer.getBoundingClientRect();
                    elements.push({
                        type: 'footer',
                        element: footer,
                        top: footerRect.top - containerRect.top,
                        bottom: footerRect.bottom - containerRect.top,
                        height: footer.offsetHeight
                    });
                    
                    // 计算分割点
                    const segments = [];
                    let currentSegment = { start: 0, end: 0, height: 0, includeHeader: true };
                    let headerHeight = header.offsetHeight;
                    currentSegment.height = headerHeight;
                    
                    for (let i = 1; i < elements.length; i++) {
                        const element = elements[i];
                        const potentialHeight = element.bottom - currentSegment.start;
                        
                        // 检查是否需要创建新分段
                        if (potentialHeight > maxHeight && currentSegment.height > headerHeight) {
                            // 在前一个元素结束处分割
                            currentSegment.end = elements[i - 1].bottom;
                            segments.push(currentSegment);
                            
                            // 开始新分段
                            currentSegment = {
                                start: currentSegment.end,
                                end: 0,
                                height: element.bottom - currentSegment.end,
                                includeHeader: false
                            };
                        } else {
                            currentSegment.height = potentialHeight;
                            currentSegment.end = element.bottom;
                        }
                    }
                    
                    // 添加最后一个分段
                    if (currentSegment.height > 0) {
                        currentSegment.end = container.offsetHeight;
                        segments.push(currentSegment);
                    }
                    
                    button.textContent = `生成中 (0/${segments.length})...`;
                    
                    // 隐藏保存按钮
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'hidden';
                    
                    // 为每个分段生成图片
                    const images = [];
                    for (let i = 0; i < segments.length; i++) {
                        const segment = segments[i];
                        button.textContent = `生成中 (${i + 1}/${segments.length})...`;
                        
                        // 创建临时容器用于截图
                        const tempContainer = document.createElement('div');
                        tempContainer.style.cssText = `
                            position: absolute;
                            left: -9999px;
                            top: 0;
                            width: ${container.offsetWidth}px;
                            background: white;
                        `;
                        tempContainer.className = 'container';
                        
                        // 克隆容器内容
                        const clonedContainer = container.cloneNode(true);
                        
                        // 移除克隆内容中的保存按钮
                        const clonedButtons = clonedContainer.querySelector('.save-buttons');
                        if (clonedButtons) {
                            clonedButtons.style.display = 'none';
                        }
                        
                        tempContainer.appendChild(clonedContainer);
                        document.body.appendChild(tempContainer);
                        
                        // 等待DOM更新
                        await new Promise(resolve => setTimeout(resolve, 100));
                        
                        // 使用html2canvas截取特定区域
                        const canvas = await html2canvas(clonedContainer, {
                            backgroundColor: '#ffffff',
                            scale: scale,
                            useCORS: true,
                            allowTaint: false,
                            imageTimeout: 10000,
                            logging: false,
                            width: container.offsetWidth,
                            height: segment.end - segment.start,
                            x: 0,
                            y: segment.start,
                            windowWidth: window.innerWidth,
                            windowHeight: window.innerHeight
                        });
                        
                        images.push(canvas.toDataURL('image/png', 1.0));
                        
                        // 清理临时容器
                        document.body.removeChild(tempContainer);
                    }
                    
                    // 恢复按钮显示
                    buttons.style.visibility = 'visible';
                    
                    // 下载所有图片
                    const now = new Date();
                    const baseFilename = `TrendRadar_热点新闻分析_${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}_${String(now.getHours()).padStart(2, '0')}${String(now.getMinutes()).padStart(2, '0')}`;
                    
                    for (let i = 0; i < images.length; i++) {
                        const link = document.createElement('a');
                        link.download = `${baseFilename}_part${i + 1}.png`;
                        link.href = images[i];
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                        
                        // 延迟一下避免浏览器阻止多个下载
                        await new Promise(resolve => setTimeout(resolve, 100));
                    }
                    
                    button.textContent = `已保存 ${segments.length} 张图片!`;
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                    
                } catch (error) {
                    console.error('分段保存失败:', error);
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'visible';
                    button.textContent = '保存失败';
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                }
            }
            
            document.addEventListener('DOMContentLoaded', function() {
                window.scrollTo(0, 0);
            });
        </script>
    </body>
    </html>
    